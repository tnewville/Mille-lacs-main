<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ML Smallmouth — Diag</title>
<style>
  body{margin:0;background:#07131d;color:#e7f1ff;font-family:system-ui}
  #c{display:block;margin:16px auto;background:#0b2a42;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.45)}
  #s{position:fixed;left:8px;bottom:8px;background:rgba(0,0,0,.6);padding:6px 10px;border-radius:8px;font:12px system-ui;white-space:pre}
</style>
</head>
<body>
<div style="text-align:center;padding:10px">Diagnostic build — you should see a checkerboard and green fish.</div>
<canvas id="c" width="800" height="450"></canvas>
<div id="s">status…</div>
<script>
(function(){
  const c=document.getElementById('c'), ctx=c.getContext('2d');
  const s=document.getElementById('s');
  let tick=0, useRAF=true;
  const W=()=>c.clientWidth||c.width, H=()=>c.clientHeight||c.height;

  // checkerboard
  function checker(){
    const w=W(),h=H();
    for(let y=0;y<h;y+=40){
      for(let x=0;x<w;x+=40){
        ctx.fillStyle=((x+y)/40)%2?'#14415e':'#0e3046';
        ctx.fillRect(x,y,40,40);
      }
    }
  }

  // simple fish
  const fish=[];
  function spawn(n=8){
    for(let i=0;i<n;i++){
      fish.push({x:40+Math.random()*(W()-80), y:H()*0.25+Math.random()*(H()*0.7),
        dir:Math.random()<0.5?-1:1, t:Math.random()*6.283, vx:(Math.random()<0.5?-1:1)*(0.5+Math.random()*0.5)});
    }
  }
  spawn(10);

  function drawFish(){
    for(const f of fish){
      ctx.save(); ctx.translate(f.x,f.y); ctx.scale(f.dir,1);
      ctx.fillStyle='#8be68b';
      ctx.beginPath(); ctx.ellipse(0,0,18,10,0,0,Math.PI*2); ctx.fill();
      ctx.beginPath(); ctx.moveTo(-18,0); ctx.lineTo(-26,-6); ctx.lineTo(-26,6); ctx.closePath(); ctx.fill();
      ctx.fillStyle='#05201a'; ctx.beginPath(); ctx.arc(8,-3,2,0,Math.PI*2); ctx.fill();
      ctx.restore();
    }
  }

  function frame(){
    tick++;
    for(const f of fish){
      f.t+=0.03; f.x+=f.vx+Math.cos(f.t)*0.3; f.y+=Math.sin(f.t*0.7)*0.6;
      if(f.x<12){f.x=12;f.vx=Math.abs(f.vx);f.dir=1}
      if(f.x>W()-12){f.x=W()-12;f.vx=-Math.abs(f.vx);f.dir=-1}
      if(f.y<H()*0.22)f.y=H()*0.22; if(f.y>H()*0.96)f.y=H()*0.96;
    }
    ctx.clearRect(0,0,W(),H());
    checker(); drawFish();
    s.textContent=`tick ${tick}\nW×H ${W()}×${H()}\ncanvas ${c.width}×${c.height}`;
    if(useRAF) requestAnimationFrame(frame); else setTimeout(frame,16);
  }

  // rAF fallback if throttled
  setTimeout(()=>{ if(tick===0){ useRAF=false; frame(); } }, 800);

  // kick off
  frame();
})();
</script>
</body>
</html>
